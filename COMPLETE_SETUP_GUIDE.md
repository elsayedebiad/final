# 🚀 دليل الإعداد الكامل لربط Google Sheets بالنظام

## 📋 **ملخص الميزة:**
ربط ملف Google Sheet واحد مباشرة بالنظام بحيث:
- ✅ أي إضافة جديدة في الشيت تظهر تلقائياً في النظام
- ✅ مزامنة تلقائية كل دقيقة (قابلة للتخصيص)
- ✅ إشعارات فورية عند إضافة بيانات جديدة
- ✅ إحصائيات مفصلة عن المزامنة
- ✅ دعم 43 حقل + رابط الفيديو

---

## 🔧 **الخطوات التفصيلية:**

### **الخطوة 1: إعداد Google Cloud Project**

1. **اذهب إلى Google Cloud Console:**
   - [https://console.cloud.google.com/](https://console.cloud.google.com/)

2. **أنشئ مشروع جديد:**
   - اضغط "Select a project" → "New Project"
   - اسم المشروع: `CV Management System`
   - اضغط "Create"

3. **فعّل Google Sheets API:**
   - اذهب إلى "APIs & Services" → "Library"
   - ابحث عن "Google Sheets API"
   - اضغط "Enable"

### **الخطوة 2: إنشاء Service Account**

1. **اذهب إلى Service Accounts:**
   - "IAM & Admin" → "Service Accounts"

2. **أنشئ Service Account:**
   - اضغط "Create Service Account"
   - الاسم: `cv-management-sheets`
   - الوصف: `Service account for CV management Google Sheets integration`
   - اضغط "Create and Continue"

3. **تعيين الصلاحيات:**
   - Role: اختر "Editor"
   - اضغط "Continue" → "Done"

### **الخطوة 3: تحميل مفتاح JSON**

1. **إنشاء مفتاح:**
   - اضغط على Service Account الذي أنشأته
   - تبويب "Keys" → "Add Key" → "Create New Key"
   - اختر "JSON" → "Create"

2. **حفظ الملف:**
   - سيتم تحميل ملف JSON
   - احتفظ به في مكان آمن
   - **لا تشاركه مع أحد!**

### **الخطوة 4: إنشاء Google Sheet**

1. **إنشاء الشيت:**
   - اذهب إلى [Google Sheets](https://sheets.google.com)
   - "Blank" → أنشئ شيت جديد
   - سمّه: **"نظام إدارة السير الذاتية - مباشر"**

2. **نسخ Sheet ID:**
   - من الرابط: `https://docs.google.com/spreadsheets/d/SHEET_ID_HERE/edit`
   - انسخ الجزء بين `/d/` و `/edit`

3. **إضافة العناوين:**
   - انسخ العناوين من ملف `GOOGLE_SHEET_HEADERS.txt`
   - ألصقها في الصف الأول

### **الخطوة 5: مشاركة الشيت**

1. **مشاركة مع Service Account:**
   - في الشيت، اضغط "Share" (زر المشاركة)
   - أضف البريد الإلكتروني من ملف JSON (`client_email`)
   - صلاحية: **Editor**
   - اضغط "Send"

### **الخطوة 6: إعداد متغيرات البيئة**

1. **أنشئ ملف `.env.local`:**
   ```bash
   # في مجلد المشروع
   touch .env.local
   ```

2. **أضف المتغيرات:**
   ```env
   # Google Sheets Configuration
   GOOGLE_SHEETS_ID=your_sheet_id_here
   GOOGLE_CLIENT_EMAIL=your-service-account@your-project.iam.gserviceaccount.com
   GOOGLE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nYour_Private_Key_Here\n-----END PRIVATE KEY-----"
   ```

3. **احصل على القيم من ملف JSON:**
   - `GOOGLE_SHEETS_ID`: من رابط الشيت
   - `GOOGLE_CLIENT_EMAIL`: من `client_email` في JSON
   - `GOOGLE_PRIVATE_KEY`: من `private_key` في JSON

### **الخطوة 7: تشغيل النظام**

1. **تثبيت المكتبات:**
   ```bash
   npm install googleapis
   ```

2. **تشغيل الخادم:**
   ```bash
   npm run dev
   ```

3. **اختبار الاتصال:**
   - اذهب إلى `/dashboard/google-sheets`
   - اضغط "مزامنة البيانات"
   - يجب أن تظهر رسالة نجاح

---

## 🎯 **كيفية الاستخدام:**

### **1. تفعيل المزامنة التلقائية:**
- في صفحة Google Sheets
- اضغط "تفعيل المزامنة التلقائية"
- اختر الفترة الزمنية (1 دقيقة مُوصى بها)

### **2. إضافة بيانات جديدة:**
- افتح Google Sheet
- أضف صف جديد مع البيانات
- خلال دقيقة واحدة ستظهر في النظام تلقائياً
- ستحصل على إشعار فوري

### **3. مراقبة الإحصائيات:**
- في صفحة Google Sheets
- شاهد عدد السير المضافة والمحدثة
- راقب الأخطاء إن وجدت

---

## 📊 **الحقول المدعومة (43 حقل):**

### **المعلومات الأساسية:**
- الاسم الكامل ⭐ (مطلوب)
- الاسم بالعربية
- البريد الإلكتروني
- رقم الهاتف
- رمز المرجع

### **تفاصيل التوظيف:**
- الراتب الشهري
- فترة العقد
- المنصب

### **معلومات جواز السفر:**
- رقم جواز السفر
- تاريخ إصدار الجواز
- تاريخ انتهاء الجواز
- مكان إصدار الجواز

### **المعلومات الشخصية:**
- الجنسية، الديانة، تاريخ الميلاد
- مكان الميلاد، مكان السكن
- الحالة الاجتماعية، عدد الأطفال
- الوزن، الطول، لون البشرة، العمر

### **اللغات والمهارات:**
- مستوى الإنجليزية، مستوى العربية
- رعاية الأطفال، التدريس، التنظيف
- الغسيل، الكي، الطبخ العربي
- الخياطة، القيادة، وغيرها

### **🎥 رابط الفيديو (جديد!):**
- رابط فيديو تعريفي لكل مرشح

---

## ⚠️ **نصائح مهمة:**

### **الأمان:**
- 🔒 لا تشارك ملف JSON مع أحد
- 🔒 احتفظ بنسخة احتياطية من المتغيرات
- 🔒 تأكد من أن `.env.local` في `.gitignore`

### **الأداء:**
- ⚡ استخدم فترة مزامنة مناسبة (1-5 دقائق)
- ⚡ راقب الأخطاء وأصلحها فوراً
- ⚡ تأكد من صحة تنسيق البيانات

### **التنسيق:**
- 📅 التواريخ: `YYYY-MM-DD`
- 🔢 الأرقام: بدون فواصل
- ✅ المهارات: `نعم` / `لا` / `مستعد`
- 💍 الحالة الاجتماعية: `متزوج` / `أعزب` / `مطلق` / `أرمل`

---

## 🎉 **المميزات المتاحة:**

✅ **مزامنة فورية** - البيانات تظهر خلال دقيقة
✅ **إشعارات ذكية** - تنبيهات عند إضافة بيانات جديدة
✅ **إحصائيات مفصلة** - تتبع كامل للعمليات
✅ **معالجة الأخطاء** - تقارير واضحة عن المشاكل
✅ **واجهة سهلة** - إدارة بسيطة من لوحة التحكم
✅ **دعم كامل** - جميع الحقول المطلوبة + الفيديو

---

## 📞 **استكشاف الأخطاء:**

### **خطأ في المصادقة:**
- تحقق من `GOOGLE_CLIENT_EMAIL`
- تحقق من `GOOGLE_PRIVATE_KEY`
- تأكد من مشاركة الشيت مع Service Account

### **خطأ في الشيت:**
- تحقق من `GOOGLE_SHEETS_ID`
- تأكد من وجود العناوين في الصف الأول
- تحقق من صلاحيات المشاركة

### **خطأ في البيانات:**
- تأكد من وجود "الاسم الكامل"
- تحقق من تنسيق التواريخ
- راجع القيم المقبولة للحقول

---

**🎊 النظام جاهز! أضف بياناتك في Google Sheet وشاهدها تظهر تلقائياً في النظام!**
