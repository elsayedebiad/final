const XLSX = require('xlsx')
const path = require('path')

function createExcelTemplate() {
  console.log('๐ ุฅูุดุงุก ูุงูุจ Excel ููุณูุฑ ุงูุฐุงุชูุฉ...')

  // ุงูุนูุงููู ุจุงูุชุฑุชูุจ ุงููุทููุจ
  const headers = [
    // ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ
    'ุงูุงุณู ุงููุงูู',
    'ุงูุงุณู ุจุงูุนุฑุจูุฉ', 
    'ุงูุจุฑูุฏ ุงูุฅููุชุฑููู',
    'ุฑูู ุงููุงุชู',
    'ุฑูุฒ ุงููุฑุฌุน',
    
    // ุชูุงุตูู ุงูุชูุธูู
    'ุงูุฑุงุชุจ ุงูุดูุฑู',
    'ูุชุฑุฉ ุงูุนูุฏ',
    'ุงูููุตุจ',
    
    // ูุนูููุงุช ุฌูุงุฒ ุงูุณูุฑ
    'ุฑูู ุฌูุงุฒ ุงูุณูุฑ',
    'ุชุงุฑูุฎ ุฅุตุฏุงุฑ ุงูุฌูุงุฒ',
    'ุชุงุฑูุฎ ุงูุชูุงุก ุงูุฌูุงุฒ',
    'ููุงู ุฅุตุฏุงุฑ ุงูุฌูุงุฒ',
    
    // ุงููุนูููุงุช ุงูุดุฎุตูุฉ
    'ุงูุฌูุณูุฉ',
    'ุงูุฏูุงูุฉ',
    'ุชุงุฑูุฎ ุงููููุงุฏ',
    'ููุงู ุงููููุงุฏ',
    'ููุงู ุงูุณูู',
    'ุงูุญุงูุฉ ุงูุงุฌุชูุงุนูุฉ',
    'ุนุฏุฏ ุงูุฃุทูุงู',
    'ุงููุฒู',
    'ุงูุทูู',
    'ููู ุงูุจุดุฑุฉ',
    'ุงูุนูุฑ',
    
    // ุงููุบุงุช
    'ูุณุชูู ุงูุฅูุฌููุฒูุฉ',
    'ูุณุชูู ุงูุนุฑุจูุฉ',
    
    // ุงูููุงุฑุงุช ูุงูุฎุจุฑุงุช
    'ุฑุนุงูุฉ ุงูุฃุทูุงู',
    'ุฑุนุงูุฉ ุงูุฃุทูุงู ุงููุชูุฏูุฉ',
    'ุงูุชุฏุฑูุณ',
    'ุฑุนุงูุฉ ุฐูู ุงูุงุญุชูุงุฌุงุช ุงูุฎุงุตุฉ',
    'ุงูุชูุธูู',
    'ุงูุบุณูู',
    'ุงููู',
    'ุงูุทุจุฎ ุงูุนุฑุจู',
    'ุงูุฎูุงุทุฉ',
    'ุงูููุงุฏุฉ',
    
    // ุงูุฎุจุฑุฉ ูุงูุชุนููู
    'ุงูุฎุจุฑุฉ ุงูุณุงุจูุฉ',
    'ุงูุฎุจุฑุฉ',
    'ุงูุชุนููู',
    'ุงูููุงุฑุงุช',
    'ุงูููุฎุต',
    
    // ุฅุนุฏุงุฏุงุช ุงููุธุงู
    'ุงูุฃููููุฉ',
    'ููุงุญุธุงุช',
    
    // ุฑุงุจุท ุงูููุฏูู (ุฌุฏูุฏ)
    'ุฑุงุจุท ุงูููุฏูู'
  ]

  // ุจูุงูุงุช ุชุฌุฑูุจูุฉ (3 ุฃูุซูุฉ)
  const sampleData = [
    [
      // ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ
      'ูุงุทูุฉ ุฃุญูุฏ ูุญูุฏ',
      'ูุงุทูุฉ ุฃุญูุฏ ูุญูุฏ',
      'fatima.ahmed@email.com',
      '+201234567890',
      'FA001',
      
      // ุชูุงุตูู ุงูุชูุธูู
      '2500',
      '24 ุดูุฑ',
      'ูุฑุจูุฉ ุฃุทูุงู',
      
      // ูุนูููุงุช ุฌูุงุฒ ุงูุณูุฑ
      'A12345678',
      '2020-01-15',
      '2030-01-15',
      'ุงููุงูุฑุฉ',
      
      // ุงููุนูููุงุช ุงูุดุฎุตูุฉ
      'ูุตุฑูุฉ',
      'ูุณููุฉ',
      '1990-05-20',
      'ุงููุงูุฑุฉ',
      'ุงูุฌูุฒุฉ',
      'ูุชุฒูุฌุฉ',
      '2',
      '65 ูููู',
      '165 ุณู',
      'ุณูุฑุงุก',
      '34',
      
      // ุงููุบุงุช
      'ูุนู',
      'ูุนู',
      
      // ุงูููุงุฑุงุช ูุงูุฎุจุฑุงุช
      'ูุนู',
      'ูุนู',
      'ูุณุชุนุฏุฉ',
      'ูุง',
      'ูุนู',
      'ูุนู',
      'ูุนู',
      'ูุนู',
      'ูุณุชุนุฏุฉ',
      'ูุง',
      
      // ุงูุฎุจุฑุฉ ูุงูุชุนููู
      'ุงูุณุนูุฏูุฉ 2018-2020ุ ุงููููุช 2020-2022',
      'ุฎุจุฑุฉ 6 ุณููุงุช ูู ุฑุนุงูุฉ ุงูุฃุทูุงู ูุงูุฃุนูุงู ุงูููุฒููุฉ',
      'ุฏุจููู ุชุฌุงุฑุฉ',
      'ุฑุนุงูุฉ ุงูุฃุทูุงูุ ุงูุทุจุฎุ ุงูุชูุธูู',
      'ูุฑุจูุฉ ูุญุชุฑูุฉ ูุน ุฎุจุฑุฉ ูุงุณุนุฉ ูู ุฑุนุงูุฉ ุงูุฃุทูุงู',
      
      // ุฅุนุฏุงุฏุงุช ุงููุธุงู
      'ุนุงููุฉ',
      'ุฎุจุฑุฉ ููุชุงุฒุฉ',
      
      // ุฑุงุจุท ุงูููุฏูู
      'https://example.com/video1'
    ],
    [
      // ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ
      'ูุฑูู ุญุณู ุนูู',
      'ูุฑูู ุญุณู ุนูู',
      'mariam.hassan@email.com',
      '+201987654321',
      'MH002',
      
      // ุชูุงุตูู ุงูุชูุธูู
      '2800',
      '24 ุดูุฑ',
      'ุนุงููุฉ ููุฒููุฉ',
      
      // ูุนูููุงุช ุฌูุงุฒ ุงูุณูุฑ
      'B87654321',
      '2019-03-10',
      '2029-03-10',
      'ุงูุฅุณููุฏุฑูุฉ',
      
      // ุงููุนูููุงุช ุงูุดุฎุตูุฉ
      'ูุตุฑูุฉ',
      'ูุณูุญูุฉ',
      '1985-12-08',
      'ุงูุฅุณููุฏุฑูุฉ',
      'ุงูุฅุณููุฏุฑูุฉ',
      'ุนุฒุจุงุก',
      '0',
      '58 ูููู',
      '160 ุณู',
      'ุจูุถุงุก',
      '39',
      
      // ุงููุบุงุช
      'ูุณุชุนุฏุฉ',
      'ูุนู',
      
      // ุงูููุงุฑุงุช ูุงูุฎุจุฑุงุช
      'ูุณุชุนุฏุฉ',
      'ูุนู',
      'ูุง',
      'ูุณุชุนุฏุฉ',
      'ูุนู',
      'ูุนู',
      'ูุนู',
      'ูุนู',
      'ูุนู',
      'ูุง',
      
      // ุงูุฎุจุฑุฉ ูุงูุชุนููู
      'ุงูุฅูุงุฑุงุช 2015-2018ุ ูุทุฑ 2019-2021',
      'ุฎุจุฑุฉ 8 ุณููุงุช ูู ุงูุฃุนูุงู ุงูููุฒููุฉ ูุงูุชูุธูู',
      'ุงูุซุงูููุฉ ุงูุนุงูุฉ',
      'ุงูุชูุธููุ ุงูุทุจุฎุ ุงูุฎูุงุทุฉุ ุฑุนุงูุฉ ูุจุงุฑ ุงูุณู',
      'ุนุงููุฉ ููุฒููุฉ ูุงูุฑุฉ ูุน ุฎุจุฑุฉ ุทูููุฉ',
      
      // ุฅุนุฏุงุฏุงุช ุงููุธุงู
      'ูุชูุณุทุฉ',
      'ููุงุณุจุฉ ููุนุงุฆูุงุช ุงููุจูุฑุฉ',
      
      // ุฑุงุจุท ุงูููุฏูู
      'https://example.com/video2'
    ],
    [
      // ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ
      'ุนุงุฆุดุฉ ูุญููุฏ ุฅุจุฑุงููู',
      'ุนุงุฆุดุฉ ูุญููุฏ ุฅุจุฑุงููู',
      'aisha.mahmoud@email.com',
      '+201122334455',
      'AM003',
      
      // ุชูุงุตูู ุงูุชูุธูู
      '3000',
      '36 ุดูุฑ',
      'ูุฑุจูุฉ ููุฏุฑุณุฉ',
      
      // ูุนูููุงุช ุฌูุงุฒ ุงูุณูุฑ
      'C11223344',
      '2021-06-20',
      '2031-06-20',
      'ุฃุณูุงู',
      
      // ุงููุนูููุงุช ุงูุดุฎุตูุฉ
      'ูุตุฑูุฉ',
      'ูุณููุฉ',
      '1988-09-15',
      'ุฃุณูุงู',
      'ุงููุงูุฑุฉ',
      'ูุทููุฉ',
      '1',
      '70 ูููู',
      '170 ุณู',
      'ุณูุฑุงุก',
      '36',
      
      // ุงููุบุงุช
      'ูุนู',
      'ูุนู',
      
      // ุงูููุงุฑุงุช ูุงูุฎุจุฑุงุช
      'ูุนู',
      'ูุนู',
      'ูุนู',
      'ูุณุชุนุฏุฉ',
      'ูุนู',
      'ูุนู',
      'ูุนู',
      'ูุนู',
      'ูุง',
      'ูุณุชุนุฏุฉ',
      
      // ุงูุฎุจุฑุฉ ูุงูุชุนููู
      'ุงูุณุนูุฏูุฉ 2016-2019ุ ุงููููุช 2020-2023',
      'ุฎุจุฑุฉ 10 ุณููุงุช ูู ุงูุชุฏุฑูุณ ูุฑุนุงูุฉ ุงูุฃุทูุงู',
      'ุจูุงููุฑููุณ ุชุฑุจูุฉ',
      'ุงูุชุฏุฑูุณุ ุฑุนุงูุฉ ุงูุฃุทูุงูุ ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ',
      'ูุฏุฑุณุฉ ููุฑุจูุฉ ูุญุชุฑูุฉ ูุน ูุคูู ุฌุงูุนู',
      
      // ุฅุนุฏุงุฏุงุช ุงููุธุงู
      'ุนุงููุฉ',
      'ูุคูู ุนุงูู ูููุงุณุจุฉ ููุชุฏุฑูุณ',
      
      // ุฑุงุจุท ุงูููุฏูู
      'https://example.com/video3'
    ]
  ]

  // ุฅูุดุงุก ุงูู workbook
  const wb = XLSX.utils.book_new()
  
  // ุฅูุดุงุก ุงูู worksheet ูุน ุงูุนูุงููู ูุงูุจูุงูุงุช
  const wsData = [headers, ...sampleData]
  const ws = XLSX.utils.aoa_to_sheet(wsData)

  // ุชูุณูู ุงูุนูุงููู
  const headerStyle = {
    font: { bold: true, color: { rgb: "FFFFFF" } },
    fill: { fgColor: { rgb: "366092" } },
    alignment: { horizontal: "center", vertical: "center" }
  }

  // ุชุทุจูู ุงูุชูุณูู ุนูู ุงูุนูุงููู
  for (let i = 0; i < headers.length; i++) {
    const cellAddress = XLSX.utils.encode_cell({ r: 0, c: i })
    if (!ws[cellAddress]) ws[cellAddress] = {}
    ws[cellAddress].s = headerStyle
  }

  // ุชุนููู ุนุฑุถ ุงูุฃุนูุฏุฉ
  const colWidths = headers.map(() => ({ wch: 20 }))
  ws['!cols'] = colWidths

  // ุฅุถุงูุฉ ุงูู worksheet ุฅูู ุงูู workbook
  XLSX.utils.book_append_sheet(wb, ws, 'ุงูุณูุฑ ุงูุฐุงุชูุฉ')

  // ุฅูุดุงุก ูุฑูุฉ ุงูุชุนูููุงุช
  const instructionsData = [
    ['ุชุนูููุงุช ุงุณุชุฎุฏุงู ูุงูุจ ุงูุณูุฑ ุงูุฐุงุชูุฉ'],
    [''],
    ['ุงูููู ุงูููุจููุฉ ููุญููู:'],
    [''],
    ['ุงูุญุงูุฉ ุงูุงุฌุชูุงุนูุฉ:', 'ุฃุนุฒุจุ ุนุฒุจุงุกุ ูุชุฒูุฌุ ูุชุฒูุฌุฉุ ูุทููุ ูุทููุฉุ ุฃุฑููุ ุฃุฑููุฉ'],
    ['ูุณุชูู ุงูููุงุฑุงุช:', 'ูุนูุ ูุงุ ูุณุชุนุฏุ ูุณุชุนุฏุฉ'],
    ['ุงูุฃููููุฉ:', 'ููุฎูุถุฉุ ูุชูุณุทุฉุ ุนุงููุฉุ ุนุงุฌูุฉ'],
    [''],
    ['ููุงุญุธุงุช ูููุฉ:'],
    ['โข ุงูุงุณู ุงููุงูู ูุทููุจ (ูุง ูููู ุชุฑูู ูุงุฑุบุงู)'],
    ['โข ุงูุชูุงุฑูุฎ ุจุชูุณูู: YYYY-MM-DD (ูุซุงู: 2020-01-15)'],
    ['โข ุงูุฃุฑูุงู ุจุฏูู ููุงุตู ุฃู ุฑููุฒ ุฅุถุงููุฉ'],
    ['โข ุฑุงุจุท ุงูููุฏูู ูุฌุจ ุฃู ูููู ุฑุงุจุท ุตุญูุญ (ูุซุงู: https://youtube.com/watch?v=...)'],
    [''],
    ['ุฎุทูุงุช ุงูุงุณุชุฎุฏุงู:'],
    ['1. ุงุญุฐู ุงูุตููู ุงูุชุฌุฑูุจูุฉ (ุงูุตููู 2ุ 3ุ 4)'],
    ['2. ุฃุถู ุจูุงูุงุชู ุงูุญููููุฉ'],
    ['3. ุงุญูุธ ุงูููู'],
    ['4. ุงุฑูุนู ูู ุงููุธุงู ุฃู ุงุณุชุฎุฏู Google Sheets ูููุฒุงููุฉ ุงูุชููุงุฆูุฉ']
  ]

  const instructionsWs = XLSX.utils.aoa_to_sheet(instructionsData)
  
  // ุชูุณูู ูุฑูุฉ ุงูุชุนูููุงุช
  instructionsWs['!cols'] = [{ wch: 30 }, { wch: 50 }]
  
  // ุชูุณูู ุงูุนููุงู ุงูุฑุฆูุณู
  if (instructionsWs['A1']) {
    instructionsWs['A1'].s = {
      font: { bold: true, size: 16, color: { rgb: "FFFFFF" } },
      fill: { fgColor: { rgb: "D32F2F" } },
      alignment: { horizontal: "center" }
    }
  }

  XLSX.utils.book_append_sheet(wb, instructionsWs, 'ุงูุชุนูููุงุช')

  // ุญูุธ ุงูููู
  const fileName = 'ูุงูุจ_ุงูุณูุฑ_ุงูุฐุงุชูุฉ_ุงููุงูู.xlsx'
  const filePath = path.join(__dirname, '..', fileName)
  
  XLSX.writeFile(wb, filePath)
  
  console.log(`โ ุชู ุฅูุดุงุก ูุงูุจ Excel ุจูุฌุงุญ: ${fileName}`)
  console.log(`๐ ูุณุงุฑ ุงูููู: ${filePath}`)
  console.log(`๐ ุนุฏุฏ ุงูุญููู: ${headers.length}`)
  console.log(`๐ ูุญุชูู ุนูู: ${sampleData.length} ุฃูุซูุฉ ุชุฌุฑูุจูุฉ`)
  console.log(`๐ฅ ูุชุถูู: ุญูู ุฑุงุจุท ุงูููุฏูู`)
  
  return filePath
}

// ุชุดุบูู ุงูุฏุงูุฉ ุฅุฐุง ุชู ุงุณุชุฏุนุงุก ุงูููู ูุจุงุดุฑุฉ
if (require.main === module) {
  try {
    createExcelTemplate()
  } catch (error) {
    console.error('โ ุฎุทุฃ ูู ุฅูุดุงุก ูุงูุจ Excel:', error.message)
    console.log('๐ก ุชุฃูุฏ ูู ุชุซุจูุช ููุชุจุฉ xlsx: npm install xlsx')
  }
}

module.exports = { createExcelTemplate }
